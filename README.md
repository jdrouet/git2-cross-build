# Git2 cross building

This is just an example of how to build git2 from amd64 to arm64

## Testing

```bash
docker run --rm -it --platform linux/amd64 -v $(pwd):/code -w /code rust:1-bookworm bash
# and then
bash build.sh
```

## Actual result

```
error: linking with `cc` failed: exit status: 1
  |
  = note: LC_ALL="C" PATH="/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/x86_64-unknown-linux-gnu/bin:/usr/local/cargo/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin" VSLANG="1033" "cc" "/tmp/rustcr4vS3g/symbols.o" "/code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o" "/code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.1l6athp2taycqu1x.rcgu.o" "-Wl,--as-needed" "-L" "/code/target/aarch64-unknown-linux-gnu/release/deps" "-L" "/code/target/release/deps" "-L" "/code/target/aarch64-unknown-linux-gnu/release/build/libgit2-sys-4842b400c933ab74/out/build" "-L" "/code/target/aarch64-unknown-linux-gnu/release/build/libssh2-sys-ac7e23439e33599c/out/build" "-L" "/code/target/aarch64-unknown-linux-gnu/release/build/libz-sys-d008758a3a84270d/out/lib" "-L" "/code/target/aarch64-unknown-linux-gnu/release/build/libz-sys-d008758a3a84270d/out/lib" "-L" "/usr/lib/x86_64-linux-gnu" "-L" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib" "-Wl,-Bstatic" "/code/target/aarch64-unknown-linux-gnu/release/deps/libgit2-53a2d1bdc443576e.rlib" "/code/target/aarch64-unknown-linux-gnu/release/deps/libopenssl_probe-416200e8610eee78.rlib" "/code/target/aarch64-unknown-linux-gnu/release/deps/liburl-62b921a23c6ded64.rlib" "/code/target/aarch64-unknown-linux-gnu/release/deps/libidna-f9f42218b749c9d4.rlib" "/code/target/aarch64-unknown-linux-gnu/release/deps/libunicode_normalization-81b959389eb0580c.rlib" "/code/target/aarch64-unknown-linux-gnu/release/deps/libtinyvec-ef1bde41571565b5.rlib" "/code/target/aarch64-unknown-linux-gnu/release/deps/libtinyvec_macros-0762584a9d218552.rlib" "/code/target/aarch64-unknown-linux-gnu/release/deps/libunicode_bidi-8ba412301720372a.rlib" "/code/target/aarch64-unknown-linux-gnu/release/deps/libform_urlencoded-2871f5c19a9a36ca.rlib" "/code/target/aarch64-unknown-linux-gnu/release/deps/libpercent_encoding-0740830791bae1ee.rlib" "/code/target/aarch64-unknown-linux-gnu/release/deps/liblog-42316aeda1a414e1.rlib" "/code/target/aarch64-unknown-linux-gnu/release/deps/liblibgit2_sys-dc4f5799ca5991f4.rlib" "/code/target/aarch64-unknown-linux-gnu/release/deps/liblibssh2_sys-5bb63ebfc86bacff.rlib" "/code/target/aarch64-unknown-linux-gnu/release/deps/libopenssl_sys-a872ad35f7d6c0ee.rlib" "/code/target/aarch64-unknown-linux-gnu/release/deps/liblibz_sys-13542ec0e999c1b4.rlib" "/code/target/aarch64-unknown-linux-gnu/release/deps/liblibc-56903644926c4030.rlib" "/code/target/aarch64-unknown-linux-gnu/release/deps/libbitflags-32260a6b95e3a521.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/libstd-9db51037f7732c7f.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/libpanic_unwind-43f7084971578043.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/libobject-55e3c3e99d7ea57c.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/libmemchr-fb53010b8d947b31.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/libaddr2line-6f437829797b59f9.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/libgimli-c465d68cd448aa2e.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/librustc_demangle-12979ddb857b6856.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/libstd_detect-ecc5f92a35a5dcae.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/libhashbrown-09b6240c5d3892f5.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/librustc_std_workspace_alloc-e35646347e036948.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/libminiz_oxide-893df93494354b60.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/libadler-297a87c8b999e355.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/libunwind-eb6321afc60f0508.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/libcfg_if-e65240dca34fcbd0.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/liblibc-4b653d72a90009a1.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/liballoc-58548d24e1f3d56c.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/librustc_std_workspace_core-84c459117cd1fdc9.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/libcore-d6e05faaecef4023.rlib" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib/libcompiler_builtins-c35031b3bb3289ef.rlib" "-Wl,-Bdynamic" "-lssl" "-lcrypto" "-lgcc_s" "-lutil" "-lrt" "-lpthread" "-lm" "-ldl" "-lc" "-Wl,--eh-frame-hdr" "-Wl,-z,noexecstack" "-L" "/usr/local/rustup/toolchains/1.79.0-x86_64-unknown-linux-gnu/lib/rustlib/aarch64-unknown-linux-gnu/lib" "-o" "/code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b" "-Wl,--gc-sections" "-pie" "-Wl,-z,relro,-z,now" "-Wl,-O1" "-Wl,--strip-debug" "-nodefaultlibs"
  = note: /usr/bin/ld: /code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o: Relocations in generic ELF (EM: 183)
          /usr/bin/ld: /code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o: Relocations in generic ELF (EM: 183)
          /usr/bin/ld: /code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o: Relocations in generic ELF (EM: 183)
          /usr/bin/ld: /code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o: Relocations in generic ELF (EM: 183)
          /usr/bin/ld: /code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o: Relocations in generic ELF (EM: 183)
          /usr/bin/ld: /code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o: Relocations in generic ELF (EM: 183)
          /usr/bin/ld: /code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o: Relocations in generic ELF (EM: 183)
          /usr/bin/ld: /code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o: Relocations in generic ELF (EM: 183)
          /usr/bin/ld: /code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o: Relocations in generic ELF (EM: 183)
          /usr/bin/ld: /code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o: Relocations in generic ELF (EM: 183)
          /usr/bin/ld: /code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o: Relocations in generic ELF (EM: 183)
          /usr/bin/ld: /code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o: Relocations in generic ELF (EM: 183)
          /usr/bin/ld: /code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o: Relocations in generic ELF (EM: 183)
          /usr/bin/ld: /code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o: Relocations in generic ELF (EM: 183)
          /usr/bin/ld: /code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o: Relocations in generic ELF (EM: 183)
          /usr/bin/ld: /code/target/aarch64-unknown-linux-gnu/release/deps/git2_cross_build-c47799ab4041aa4b.git2_cross_build.9edab3bf2829f534-cgu.0.rcgu.o: error adding symbols: file in wrong format
          collect2: error: ld returned 1 exit status


error: could not compile `git2-cross-build` (bin "git2-cross-build") due to 1 previous error
```
